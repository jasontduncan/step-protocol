# Phase 3 â€“ Step 3.2: Implement `worktree audit`
status: done
started: 2025-11-25T20:22:30Z
completed: 2025-11-25T20:24:15Z

## Scope
Recursively validate every WorkNode under the meta-node, summarize failures, and expose a `worktree audit` command that leans on the validator.

## Plan
- [x] Build an `auditWorkNodes` helper that runs `validateWorkNode` across every discovered node and captures any errors.
- [x] Implement `worktree audit` to parse `--target`, call the helper, and print per-node summaries with exit codes when violations are found.
- [x] Confirm the CLI still compiles after wiring the audit path.

## Notes
- 2025-11-25T20:23:10Z Added `auditWorkNodes` to iterate over `discoverWorkNodes`, run `validateWorkNode`, and normalize captured errors for reporting.
- 2025-11-25T20:23:40Z Implemented `handleAudit` so `worktree audit` prints `[ok]`/`[error]` lines per node, reports how many nodes were checked, and sets a non-zero exit code when needed.
- 2025-11-25T20:29:22Z Reran `npm run build` after the audit command landed to reconfirm the CLI compiles under NodeNext.

## Outcomes
- `worktree audit` now validates every discovered WorkNode via the new audit helper and clearly surfaces missing logs or malformed entries.
- Audit output shows which roots passed, which failed, and why, making it easy to rerun the validator before promoting work.
- The command sets `process.exitCode = 1` when any node fails, enabling CI hooks to catch protocol violations early.
