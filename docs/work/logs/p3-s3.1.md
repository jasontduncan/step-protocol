# Phase 3 – Step 3.1: Implement WorkNode validator
status: done
started: 2025-11-25T20:22:30Z
completed: 2025-11-25T20:23:56Z

## Scope
Validate that WorkNodes follow the protocol: required files exist, STATE/PLAN match, logs are named/formatted correctly, and references stay consistent.

## Plan
- [x] Check that PLAN.md, STATE.md, and logs/ exist under the target root.
- [x] Parse and cross-validate PLAN/STATE content, ensuring identifiers, labels, and statuses match.
- [x] Validate log file naming and headers so logs correspond to steps.

## Notes
- 2025-11-25T20:23:10Z Added `validateWorkNode` to load a WorkNode, reuse `ensurePlanStateConsistency`, and raise detailed errors when layout, PLAN, STATE, or log metadata violate the rules.
- 2025-11-25T20:23:38Z Confirmed every STATE entry with a `progressLog` points to an existing `logs/p<P>-s<S>.md`, and verified each file matches the naming regex plus contains `status:` and `started:` headers.
- 2025-11-25T20:23:56Z Reran `npm run build` to ensure the validator compiles under the NodeNext toolchain.

## Outcomes
- WorkNode validation reports missing files, duplicate/unknown steps, or malformed logs before runners mutate the node.
- Validator covers both directed references (STATE → log) and detected log files, ensuring names align with plan steps.
- The helper is ready to be reused by the upcoming audit command so future runs check the protocol before reporting success.
